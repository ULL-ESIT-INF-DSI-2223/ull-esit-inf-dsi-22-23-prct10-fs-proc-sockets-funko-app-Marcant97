<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>practica-10</title><meta name="description" content="Documentation for practica-10"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">practica-10</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>practica-10</h2></div>
<div class="tsd-panel tsd-typography"><p><a href="https://classroom.github.com/a/NApXvVde"><img src="https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg" alt="Review Assignment Due Date"></a></p>
<p><a href="https://sonarcloud.io/summary/new_code?id=ULL-ESIT-INF-DSI-2223_ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-Marcant97"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2223_ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-Marcant97&metric=alert_status" alt="Quality Gate Status"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-Marcant97/actions/workflows/node.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-Marcant97/actions/workflows/node.js.yml/badge.svg" alt="Tests"></a></p>
<p><a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-Marcant97?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct10-fs-proc-sockets-funko-app-Marcant97/badge.svg?branch=main" alt="Coverage Status"></a></p>

<a href="#práctica-10---apis-asíncronas-de-gestión-del-sistema-de-ficheros-creación-de-procesos-y-creación-de-sockets-de-nodejs" id="práctica-10---apis-asíncronas-de-gestión-del-sistema-de-ficheros-creación-de-procesos-y-creación-de-sockets-de-nodejs" style="color: inherit; text-decoration: none;">
  <h1>Práctica 10 - APIs asíncronas de gestión del sistema de ficheros, creación de procesos y creación de sockets de Node.js</h1>
</a>

<a href="#índice" id="índice" style="color: inherit; text-decoration: none;">
  <h3>Índice</h3>
</a>
<p><a href="#ejercicio-1">1. Ejercicio 1</a>
<a href="#ejercicio-2">2. Ejercicio 2</a>
<a href="#ejercicio-3">3. Ejercicio 3</a>
<a href="#ejercicio-pe-103">4. Ejercicios PE 103</a></p>

<a href="#ejercicio-1" id="ejercicio-1" style="color: inherit; text-decoration: none;">
  <h3>Ejercicio 1</h3>
</a>
<p>Considere el siguiente ejemplo de código fuente TypeScript que hace uso del módulo fs de Node.js:</p>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">access</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">, </span><span class="hl-2">watch</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> !== </span><span class="hl-4">3</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Please, specify a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">];</span><br/><br/><span class="hl-1">  </span><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">.</span><span class="hl-7">F_OK</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">      </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> is no longer watched`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>En primer lugar, ejecute el programa para tratar de comprender qué hace.</p>
<p>A continuación, realice una traza de ejecución mostrando, paso a paso, el contenido de la pila de llamadas, el registro de eventos de la API y la cola de manejadores, además de lo que se muestra por la consola. Para ello, simule que se llevan a cabo, como mínimo, dos modificaciones del fichero helloworld.txt a lo largo de la ejecución. ¿Qué hace la función access? ¿Para qué sirve el objeto constants?</p>
<p>En la primera línea, se importan las funciones <em>access</em>, <em>constants</em> y <em>watch</em> del módulo fs de Node.js.
A continuación, nos encontramos con una estructura if-else, donde se trata de comprobar si el número de argumentos es distinto de 3. En caso de que sea así, se muestra por consola un mensaje de error. En caso contrario, se guarda el nombre del fichero en la variable filename. La función access nos permite comprobar si el fichero pasado como argumento existe, se le pasa como argumento el nombre del fichero, una constante, en este caso <em>constants.F_OK</em> , que nos permitirá comprobar que el fichero exista en el directorio actual y el último parámetro un callback <em>err</em>, encargado de manejar los posibles errores. En caso de que existiese un error, se ejecutaría la línea <code>console.log(</code>File ${filename} does not exist<code>);</code>. Si no hay error, err tomará el valor null y pasaremos a la parte del else, donde crearemos una variable de tipo <em>watch</em> con el nombre del fichero. Por último, se ejecutará el método <em>on</em> perteneciente a <em>EventEmitter</em>, que nos permite ejecutar un callback cuando se produzca un cambio en el fichero.</p>
<p>Primero entra en la pila de llamadas <code>console.log(`Starting to watch file ${filename}`);</code> y se imprime por pantalla, a continuación llega a la pila <em>watcher.on</em>, que se pasa a la web api esperando a que se produzca un cambio en el fichero. Acto seguido entra en la pila de llamadas <code>console.log(`File ${filename} is no longer watched`);</code> y se imprime por pantalla. Cuando se produce un cambio en el fichero, se <code>console.log(`File ${filename} has been modified somehow`);</code> pasa a la cola de manejadores pendiente para ejecutarse. Una vez que la pila de llamadas está vacía, se ejecuta el callback de <em>watcher.on</em> y se muestra por consola el mensaje <code>File ${filename} has been modified somehow</code>. De nuevo se ejecuta una modificación y entra en la cola de manejadores <code>console.log(`File ${filename} has been modified somehow`);</code> y se ejecuta cuando la pila de llamadas está vacía.</p>

<a href="#ejercicio-2" id="ejercicio-2" style="color: inherit; text-decoration: none;">
  <h3>Ejercicio 2</h3>
</a>
<p>En la versión 1 de este ejercicio, me creo un sobproceso que se encarga de ejecutar el comando &#39;cat&#39; y redirecciono la salida a otro subproceso usando pipes, que se encargará de contar el número de palabras, líneas y/o caracteres, según haya solicitado el usuario. La entrada del programa la he desarollado con yargs.
Para la versión 2, también ha sido desarrollada con yargs y para evitar el uso de pipes, para cada opción creo un sobproceso encargado de hacer el recuento solicitado, además de un evento &#39;data&#39; para el proceso padre, cuando esto sucede, se le redirecciona con &#39;stdin.write&#39; los datos. También existe un evento end, para terminar el proceso hijo y un evento &#39;data&#39; para el hijo, cuando esto sucede se le pasa el contenido al proceso padre con &#39;process.stdout.write&#39;.</p>

<a href="#ejercicio-3" id="ejercicio-3" style="color: inherit; text-decoration: none;">
  <h3>Ejercicio 3</h3>
</a>
<p>Para este ejercicio he creado una clase <code>MessageEventEmitterClient</code>, que extiende de la clase <code>EventEmitter</code>, que nos permite crear un cliente que se conecte a un servidor mediante sockets. Tengo además un método send que se encarga de enviar los datos hacia el servidor y un método recieve que se encarga de recibir los datos enviados por el servidor, se utiliza como carácter delimitador &#39;\n&#39; y se ejecuta un evento &#39;message&#39;. En el fichero <em>cliente.ts</em> tengo un objeto de la clase anterior, además de manejar todo lo relacionado con el paso de argumentos con <em>yargs</em> y hacer las correspondientes llamadas a send() y recieve(). También se encuentra el método <em>on(message)</em> que se encarga de procesar las respuestas provenientes del servidor.
Por otro lado se encuentra el fichero <em>types.js</em>, al que se le añadió como novedad los tipos RequesType y ResponseType utilizados para comunicarse entre cliente y servidor. También tenemos de la anterior práctica el fichero <em>funko.ts</em> y como novedad el fichero server.ts que hace la función de servidor. En él encontramos eventos como &#39;data&#39;, &#39;close&#39; y &#39;request&#39;. El evento &#39;data&#39; se ejecuta cuando se recibe información del cliente y su función es procesar la petición del mismo. El evento &#39;close&#39; se ejecuta cuando se cierra la conexión con el cliente y el evento &#39;request&#39; se ejecuta cuando se termina de responder al cliente y el servidor se encarga de cerrar la conexión con ese cliente. En este último evento se ejecuta un switch que se encarga de procesar la petición y devolver la respuesta correspondiente. En el fichero <em>server.ts</em> se encuentra también el método <em>on(message)</em> que se encarga de procesar las respuestas provenientes del servidor. Para terminar, lo más complicado fue el fichero <em>funciones.ts</em>, ya que tenía bastante código y tuve que cambiar muchas cosas, ya que había fragmentos de funciones que no eran nada cómodas para esta nueva práctica. En este fichero encontramos funciones para añadir, borrar, modificar, mostrar y listar funkos.</p>

<a href="#ejercicio-pe-103" id="ejercicio-pe-103" style="color: inherit; text-decoration: none;">
  <h3>Ejercicio PE-103</h3>
</a>
<p>En clase se solicitó crear un programa cliente-servidor haciendo uso de sockets, de la forma que se ejecute un comando unix en el cliente con sus comandos correspondiente, se envié al servidor, éste lo procese y mande de vuelta el resultado al cliente. para ello tengo un fichero <em>cliente.ts</em> y otro <em>server.ts</em>. En general conseguí realizar el ejercicio, muy similar al ejercicio- sin usar la clase <em>MessageEventEmitterClient</em>, pero no quedó perfecto, ya que al enviar la respuesta se recibía como <em>[object object]</em>, con algo más de tiempo lo hubiese arreglado.</p>

<a href="#dificultades" id="dificultades" style="color: inherit; text-decoration: none;">
  <h3>Dificultades</h3>
</a>
<p>En primer lugar, el escaso desarollo de tests en el PE  esdebido a la falta de tiempo, y en el ejercicio 3 se debe a muchos problemas relacionados con la ejecución asíncrona del código.
El código no me ha quedado tan bien como me hubiese gustado debido a la carga lectiva, tampoco he desarrollado en el tercer ejercicio la escritura y lectura de ficheros asíncrona, ya que me daba muchos errores y a falta de tiempo, preferí dejarlo como estaba funcionando perfecto.</p>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">practica-<wbr/>10</a>
<ul>
<li class="tsd-kind-module"><a href="modules/MessageEventEmitterClient.html">Message<wbr/>Event<wbr/>Emitter<wbr/>Client</a></li>
<li class="tsd-kind-module"><a href="modules/cliente.html">cliente</a></li>
<li class="tsd-kind-module"><a href="modules/funciones.html">funciones</a></li>
<li class="tsd-kind-module"><a href="modules/funko.html">funko</a></li>
<li class="tsd-kind-module"><a href="modules/server.html">server</a></li>
<li class="tsd-kind-module"><a href="modules/types.html">types</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>